"use strict";(self.webpackChunktouchgfx_documentation=self.webpackChunktouchgfx_documentation||[]).push([[63395],{49613:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(59496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(n),u=r,h=m["".concat(s,".").concat(u)]||m[u]||c[u]||i;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},89639:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(59496),r=n(97395);const i=function(e){const t=e.noShadow||!1,n=e.width,i=e.height,o=(0,r.Z)(e.imageSource);return t?a.createElement("div",{className:"figure noshadow"},a.createElement("a",{href:o,target:"_blank"},a.createElement("img",{width:n,height:i,src:o})),a.createElement("p",null,e.children)):a.createElement("div",{className:"figure"},a.createElement("a",{href:o,target:"_blank"},a.createElement("img",{width:n,height:i,src:o})),a.createElement("p",null,e.children))}},48753:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(59496),r=n(96151);const i=a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}));class o extends a.Component{render(){return a.createElement(r.Z,{color:"var(--highlight-color-further-reading)",header:"Further reading",type:"further-reading",icon:i},this.props.children)}}const l=o},96151:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(59496);class r extends a.Component{render(){const e=`highlight highlight-${this.props.type}`;return a.createElement("div",{className:e},a.createElement("div",{className:"highlight-heading"},a.createElement("h5",null,a.createElement("div",{className:"highlight-icon"},this.props.icon),this.props.header)),a.createElement("div",{className:"highlight-content"},this.props.children))}}const i=r},49018:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(59496),r=n(96151);const i=a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}));class o extends a.Component{render(){return a.createElement(r.Z,{color:"var(--highlight-color-note)",header:"Note",type:"note",icon:i},this.props.children)}}const l=o},98448:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>m,default:()=>k,frontMatter:()=>p,metadata:()=>c,toc:()=>h});n(59496);var a=n(49613),r=n(89639),i=n(49018),o=n(48753),l=n(18399);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const p={id:"scenarios-dsi-command-mode",title:"MIPI-DSI\u547d\u4ee4\u6a21\u5f0f"},m=void 0,c={unversionedId:"development/touchgfx-hal-development/scenarios/scenarios-dsi-command-mode",id:"development/touchgfx-hal-development/scenarios/scenarios-dsi-command-mode",title:"MIPI-DSI\u547d\u4ee4\u6a21\u5f0f",description:"This scenario describes how to configure MIPI DSI interface in Command Mode and TouchGFX Generator when using a display with a Display Serial Interface (DSI) and GRAM. The example used in this article will be for 16-bit RGB565 frame buffer format and goes through configurations in STM32CubeMX.",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/development/touchgfx-hal-development/scenarios/scenarios-dsi-command-mode.mdx",sourceDirName:"development/touchgfx-hal-development/scenarios",slug:"/development/touchgfx-hal-development/scenarios/scenarios-dsi-command-mode",permalink:"/4.25/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-dsi-command-mode",draft:!1,tags:[],version:"current",frontMatter:{id:"scenarios-dsi-command-mode",title:"MIPI-DSI\u547d\u4ee4\u6a21\u5f0f"},sidebar:"docs",previous:{title:"SPI Display Interface",permalink:"/4.25/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-spi"},next:{title:"\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf",permalink:"/4.25/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-configure-rtos"}},u={},h=[{value:"Configuration",id:"configuration",level:2},{value:"LTDC \u914d\u7f6e",id:"ltdc-\u914d\u7f6e",level:3},{value:"DSIHOST \u914d\u7f6e",id:"dsihost-\u914d\u7f6e",level:3},{value:"TouchGFX Generator",id:"touchgfx-generator",level:3},{value:"User Code",id:"user-code",level:2},{value:"DSIHOST / LTDC\u521d\u59cb\u5316\u987a\u5e8f",id:"dsihost-ltdc-initialization-sequence",level:3},{value:"\u66f4\u65b0\u4e86DSI\u547d\u4ee4\u6a21\u5f0f\u7684TouchGFXHAL\u7c7b",id:"touchgfxhal-class-for-dsi-command-mode",level:3},{value:"Supported Framebuffer Strategies",id:"supported-framebuffer-strategies",level:2},{value:"Single",id:"single",level:3},{value:"Double",id:"double",level:3},{value:"Partial - GRAM display",id:"partial",level:3}],f={toc:h},g="wrapper";function k(e){var{components:t}=e,n=d(e,["components"]);return(0,a.kt)(g,s({},f,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This scenario describes how to configure MIPI DSI interface in Command Mode and ",(0,a.kt)("em",{parentName:"p"},"TouchGFX Generator")," when using a display with a Display Serial Interface (DSI) and GRAM. The example used in this article will be for 16-bit RGB565 frame buffer format and goes through configurations in STM32CubeMX."),(0,a.kt)(i.Z,{mdxType:"Note"},"This scenario assumes that a working display driver has been developed during the Board Bringup phase. The driver must be able to transfer pixels to the display, and to control the memory writing position of the display. Check the datasheet for your display for further details."),(0,a.kt)("h2",s({},{id:"configuration"}),"Configuration"),(0,a.kt)("h3",s({},{id:"ltdc-\u914d\u7f6e"}),"LTDC \u914d\u7f6e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"\u6a21\u5f0f"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"\u663e\u793a\u7c7b\u578b"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"RGB565\uff0816\u4f4d\uff09-DSI\u6a21\u5f0f")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"\u5c42\u8bbe\u7f6e"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"\u5c42\u6570"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"1\u5c42")),(0,a.kt)("li",{parentName:"ul"},"\u5728",(0,a.kt)("inlineCode",{parentName:"li"},"\u7a97\u53e3\u4f4d\u7f6e"),"\u548c",(0,a.kt)("inlineCode",{parentName:"li"},"\u5e27\u7f13\u51b2\u533a\u884c\u957f\u5ea6"),"\u4ee5\u53ca",(0,a.kt)("inlineCode",{parentName:"li"},"\u5e27\u7f13\u51b2\u533a\u884c\u6570"),"\u4e2d\u8bbe\u7f6e\u5c4f\u5e55\u5206\u8fa8\u7387"),(0,a.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e",(0,a.kt)("inlineCode",{parentName:"li"},"0\u5c42-\u50cf\u7d20\u683c\u5f0f"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"RGB565")),(0,a.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e",(0,a.kt)("inlineCode",{parentName:"li"},"0\u5c42- Alpha\u6df7\u5408\u5e38\u6570"),"\u4e3a",(0,a.kt)("em",{parentName:"li"},"255")," ",(0,a.kt)(r.Z,{noShadow:!0,imageSource:"/img/development/touchgfx-hal-development/scenarios/dsi-command-mode/ltdc-config1.png",width:"600",mdxType:"Figure"},"LTDC \u914d\u7f6e")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"NVIC \u8bbe\u7f6e"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"LTDC\u5168\u5c40\u4e2d\u65ad"),"\u548c",(0,a.kt)("inlineCode",{parentName:"li"},"LTDC\u5168\u5c40\u9519\u8bef\u4e2d\u65ad"),"\u5747\u4e0d\u9700\u8981\uff0c\u5e94\u7981\u7528\u3002 ",(0,a.kt)(r.Z,{noShadow:!0,imageSource:"/img/development/touchgfx-hal-development/scenarios/dsi-command-mode/ltdc-config2.png",width:"600",mdxType:"Figure"},"LTDC NVIC \u8bbe\u7f6e"))))),(0,a.kt)("h3",s({},{id:"dsihost-\u914d\u7f6e"}),"DSIHOST \u914d\u7f6e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"\u6a21\u5f0f"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f7f\u7528TE Pin\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"DSIHost"),"\u8bbe\u7f6e\u4e3a_*\u81ea\u9002\u5e94\u547d\u4ee4\u6a21\u5f0f**"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"\u663e\u793a\u63a5\u53e3"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"\u8272\u5f69\u683c\u5f0f"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"\u201cRGB888(16\u4f4d)- DSI\u6a21\u5f0f\u201d")),(0,a.kt)("li",{parentName:"ul"},"\u6839\u636e\u663e\u793a\u5bbd\u5ea6\u8bbe\u7f6e",(0,a.kt)("inlineCode",{parentName:"li"},"Maximum Command Size")),(0,a.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u542f\u7528",(0,a.kt)("em",{parentName:"li"},"LTDC"),"\u5c06\u663e\u793a\u5e27\u7f13\u51b2\u533a\u7684",(0,a.kt)("inlineCode",{parentName:"li"},"\u5237\u65b0\u8bbe\u7f6e\u4e3a\u624b\u52a8\u89e6\u53d1")),(0,a.kt)("li",{parentName:"ul"},"\u5176\u4f59\u914d\u7f6e\u53d6\u51b3\u4e8e\u6240\u9009\u7684LCD HW ",(0,a.kt)(r.Z,{noShadow:!0,imageSource:"/img/development/touchgfx-hal-development/scenarios/dsi-command-mode/dsihost-config1.png",width:"600",mdxType:"Figure"},"DSIHOST \u914d\u7f6e")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"NVIC \u8bbe\u7f6e"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u542f\u7528",(0,a.kt)("inlineCode",{parentName:"li"},"DSI\u5168\u5c40\u4e2d\u65ad")," ",(0,a.kt)(r.Z,{noShadow:!0,imageSource:"/img/development/touchgfx-hal-development/scenarios/dsi-command-mode/dsihost-config2.png",width:"600",mdxType:"Figure"},"DSIHOST NVIC \u8bbe\u7f6e"))))),(0,a.kt)("h3",s({},{id:"touchgfx-generator"}),"TouchGFX Generator"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"\u6a21\u5f0f"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u542f\u7528",(0,a.kt)("em",{parentName:"li"},"\u56fe\u5f62\u5e94\u7528\u7a0b\u5e8f")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"TouchGFX Generator"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"\u663e\u793a/\u63a5\u53e3"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"\u5e76\u884cRGB\uff08LTDC\uff09"),"\uff0c\u56e0\u4e3a\u8fd9\u4ecd\u662f\u5e94\u7528\u7a0b\u5e8f\u4e0e\u4e4b\u901a\u4fe1\u7684\u63a7\u5236\u5668\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5c06",(0,a.kt)("inlineCode",{parentName:"li"},"\u5e94\u7528\u8ba1\u65f6\u6e90"),"\u8bbe\u7f6e\u4e3a",(0,a.kt)("em",{parentName:"li"},"\u81ea\u5b9a\u4e49")," ",(0,a.kt)(r.Z,{noShadow:!0,imageSource:"/img/development/touchgfx-hal-development/scenarios/dsi-command-mode/touchgfx-generator-config.png",width:"600",mdxType:"Figure"},"TouchGFX Generator\u914d\u7f6e"))))),(0,a.kt)("h2",s({},{id:"user-code"}),"User Code"),(0,a.kt)("p",null,"The ",(0,a.kt)("em",{parentName:"p"},"TouchGFX Generator")," can only generate a partial TouchGFX AL that configures the LTDC to transfer pixels through the DSI Host controller from the framebuffer memory to the display and synchronize the display with the TouchGFX Engine. However, all necessary handles to accomplish this are generated by the TouchGFX Generator."),(0,a.kt)("p",null,"Generally, for displays with embedded GRAM, the implementation of the generated TouchGFX HAL handles in ",(0,a.kt)("inlineCode",{parentName:"p"},"TouchGFXHAL.cpp")," should perform the following steps to transfer pixels to the display and synchronize the display with the TouchGFX Engine:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},'Wait for "VSYNC" (sometimes called Tearing Effect (TE) signal) to signal the TouchGFX Engine.'),(0,a.kt)("li",{parentName:"ol"},'Based on the area of the framebuffer to be redrawn, move the "display cursor" and "active window" (the region of the display being updated) to a place in GRAM that matches this area.'),(0,a.kt)("li",{parentName:"ol"},"Prepare to write incoming pixel data to GRAM. Depending on the framebuffer strategy and display interface used, this could be swapping framebuffer pointers, signaling TouchGFX Engine, or waiting for previous transfers to complete."),(0,a.kt)("li",{parentName:"ol"},"Send pixel data.")),(0,a.kt)("p",null,"Depending on the display used and the framebuffer strategy, the implementation of the above steps will vary."),(0,a.kt)("p",null,"Some of the adjustments that may be needed specifcally for DSI Command Mode interfaces are described below."),(0,a.kt)("h3",s({},{id:"dsihost-ltdc-initialization-sequence"}),"DSIHOST / LTDC\u521d\u59cb\u5316\u987a\u5e8f"),(0,a.kt)("p",null,"\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"MX_DSIHOST_DSI_Init()"),"\u7684\u8c03\u7528\u5fc5\u987b\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"MX_LTDC_Init()"),"\u4e4b\u524d\u5b8c\u6210\u3002 This should be handled by STM32CubeMX. If this is not correct, take care to fix the order in a user code section."),(0,a.kt)("p",null,"After calling ",(0,a.kt)("inlineCode",{parentName:"p"},"HAL_DSI_Start()"),", switch DSIHOST clock to the ",(0,a.kt)("inlineCode",{parentName:"p"},"DSIPHY")," source:"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-cpp",metastring:"{12}","{12}":!0}),"static void MX_DSIHOST_DSI_Init(void)\n{\n  ...\n  /* Switch to DSI PHY PLL clock */\n  RCC_PeriphCLKInitTypeDef PeriphClkInit;\n  PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_DSI;\n  PeriphClkInit.DsiClockSelection    = RCC_DSICLKSOURCE_DSIPHY;\n  HAL_RCCEx_PeriphCLKConfig(&PeriphClkInit);\n  /* USER CODE END DSIHOST_Init 2 */\n  ...\n}\n")),(0,a.kt)("p",null,"User has to add the required initialization code specific to the used LCD controller at the end of the ",(0,a.kt)("inlineCode",{parentName:"p"},"MX_LTDC_Init()")," function. That code will be based on the DSI HAL APIs ",(0,a.kt)("inlineCode",{parentName:"p"},"HAL_DSI_ShortWrite()")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"HAL_DSI_LongWrite()"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-cpp"}),"  static void MX_LTDC_Init(void)\n  {\n    ...\n    /* USER CODE BEGIN LTDC_Init 2 */\n    // Specific LCD controller's initialization code\n    ...\n\n    // Exit Sleep Mode\n    if (HAL_DSI_ShortWrite(&hdsi, 0, DSI_DCS_SHORT_PKT_WRITE_P0, DSI_EXIT_SLEEP_MODE, 0x00) != HAL_OK)\n    {\n      Error_Handler();\n    }\n\n    HAL_Delay(120);\n    /* USER CODE END LTDC_Init 2 */\n    ...\n  }\n")),(0,a.kt)("h3",s({},{id:"touchgfxhal-class-for-dsi-command-mode"}),"\u66f4\u65b0\u4e86DSI\u547d\u4ee4\u6a21\u5f0f\u7684TouchGFXHAL\u7c7b"),(0,a.kt)("p",null,"\u9632\u6b62MIPI DSI\u663e\u793a\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u7b2c\u4e00\u5e27\u88ab\u6e32\u67d3\u4e4b\u524d\u6253\u5f00\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u4fdd\u62a4",(0,a.kt)("inlineCode",{parentName:"p"},"TouchGFXHAL::endFrame"),"\u529f\u80fd\uff0c\u4fdd\u6301\u663e\u793a\u5173\u95ed\uff0c\u76f4\u81f3TouchGFX\u6e32\u67d3\u7b2c\u4e00\u5e27\u4e3a\u6b62\u3002 ",(0,a.kt)("inlineCode",{parentName:"p"},"TouchGFXHAL::endFrame()"),"\u53ef\u50cf\u4e0b\u9762\u8fd9\u6837\u66f4\u65b0\uff0c\u901a\u8fc7\u914d\u7f6e\u4e3aPWM\u8f93\u51fa\u7684HW\u5b9a\u65f6\u5668\u542f\u7528LCD\u53ca\u5176\u80cc\u5149\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-cpp",metastring:"{7,9,11}","{7,9,11}":!0}),"void TouchGFXHAL::endFrame()\n{\n    if (!display_on)\n    {\n        display_on = true;\n        /* Enable the LCD, Send Display on DCS command to display */\n        HAL_DSI_ShortWrite(&hdsi, 0, DSI_DCS_SHORT_PKT_WRITE_P1, DSI_SET_DISPLAY_ON, 0x00);\n        /* Start PWM Timer channel */\n        (void)HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_2);\n        /* Enable Backlight by setting Brightness to 100% */\n        __HAL_TIM_SET_COMPARE(&htim8, TIM_CHANNEL_2, 2U * 100);\n    }\n\n    TouchGFXGeneratedHAL::endFrame();\n}\n")),(0,a.kt)("h2",s({},{id:"supported-framebuffer-strategies"}),"Supported Framebuffer Strategies"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Single"),(0,a.kt)("li",{parentName:"ul"},"Double"),(0,a.kt)("li",{parentName:"ul"},"Partial - GRAM display")),(0,a.kt)(o.Z,{mdxType:"FurtherReading"},"See article ",(0,a.kt)(l.Z,{to:"../../../basic-concepts/framebuffer#framebuffer-strategies",mdxType:"Link"},"Framebuffer Strategies")," for a general introduction to framebuffer strategies in TouchGFX."),(0,a.kt)("p",null,"DSI Command Mode usually has a high enough bandwidth to transfer pixels to GRAM fast than the display scans the pixels. This is very similar to to the FMC Parallel display interface. Therefore, the implementation steps for a working TouchGFX AL for DSI Command Mode is very similar to the FMC Parallel display interface."),(0,a.kt)(o.Z,{mdxType:"FurtherReading"},"See article ",(0,a.kt)(l.Z,{to:"scenarios-fmc",mdxType:"Link"},"FMC Display Interface")," for more information about the TouchGFX AL implementation."),(0,a.kt)("h3",s({},{id:"single"}),"Single"),(0,a.kt)("p",null,"Currently, no ",(0,a.kt)("em",{parentName:"p"},"TouchGFX Board Support")," have a reference implementation for Single buffering with DSI Command Mode. The setup would be similar to ",(0,a.kt)(l.Z,{to:"scenarios-fmc#single",mdxType:"Link"},"FMC Single buffer")," setup, but using DSI Command Mode driver functions instead of FMC."),(0,a.kt)("h3",s({},{id:"double"}),"Double"),(0,a.kt)("p",null,"Currently, no ",(0,a.kt)("em",{parentName:"p"},"TouchGFX Board Support")," have a reference implementation for Double buffering with DSI Command Mode. The setup would be similar to ",(0,a.kt)(l.Z,{to:"scenarios-fmc#double",mdxType:"Link"},"FMC Double buffer")," setup, but using DSI Command Mode driver functions instead of FMC."),(0,a.kt)("h3",s({},{id:"partial"}),"Partial - GRAM display"),(0,a.kt)("p",null,"Currently, no ",(0,a.kt)("em",{parentName:"p"},"TouchGFX Board Support")," have a reference implementation for ",(0,a.kt)("em",{parentName:"p"},"Partial - GRAM display")," with DSI Command Mode. The setup would be similar to ",(0,a.kt)(l.Z,{to:"scenarios-fmc#partial",mdxType:"Link"},"FMC Partial - GRAM display")," setup, but using DSI Command Mode driver functions instead of FMC."))}k.isMDXComponent=!0}}]);