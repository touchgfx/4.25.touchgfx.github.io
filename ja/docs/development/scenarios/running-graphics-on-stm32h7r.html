<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/scenarios/running-graphics-on-stm32h7r" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">STM32H7R7 &amp; S7でのグラフィックスの実行 | TouchGFX Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.25/ja/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.25/ja/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="STM32H7R7 &amp; S7でのグラフィックスの実行 | TouchGFX Documentation"><meta data-rh="true" name="description" content="この記事ではSTM32H7R/Sシリーズのマイクロコントローラ固有のアーキテクチャを取り上げ、これをグラフィックス用に使用するときに必要な考慮事項について説明します。 ただし、これらの考慮事項のほとんどは、外部RAMとFlashでグラフィックスを実行するすべてのSTM32マイクロコントローラに適用されます。"><meta data-rh="true" property="og:description" content="この記事ではSTM32H7R/Sシリーズのマイクロコントローラ固有のアーキテクチャを取り上げ、これをグラフィックス用に使用するときに必要な考慮事項について説明します。 ただし、これらの考慮事項のほとんどは、外部RAMとFlashでグラフィックスを実行するすべてのSTM32マイクロコントローラに適用されます。"><link data-rh="true" rel="icon" href="/4.25/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/ko/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/zh-CN/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/zh-TW/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.25/docs/development/scenarios/running-graphics-on-stm32h7r" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.25/ja/opensearch.xml">


<script src="/4.25/ja/js/one-trust.js"></script>
<script src="/4.25/js/fix-location.js"></script><link rel="stylesheet" href="/4.25/ja/assets/css/styles.6e57ba1f.css">
<link rel="preload" href="/4.25/ja/assets/js/runtime~main.cc0b2195.js" as="script">
<link rel="preload" href="/4.25/ja/assets/js/main.d2537797.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region" aria-label="メイン･コンテンツまでスキップ"><a class="skipToContent_xAYN" href="#__docusaurus_skipToContent_fallback">メイン･コンテンツまでスキップ</a></div><nav aria-label="Main（メイン）" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar（ナビゲーション･バーをトグル）" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.25/ja/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.25/ja/img/logo.svg" alt="TouchGFX" class="themedImage_m0dh themedImage--light_OZkp"><img src="/4.25/ja/img/logo.svg" alt="TouchGFX" class="themedImage_m0dh themedImage--dark_ViMM"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/4.25/ja/docs/introduction/welcome">ドキュメント</a><a class="navbar__item navbar__link" href="/4.25/ja/docs/api/namespacetouchgfx">API</a><a class="navbar__item navbar__link" sidebarid="academy" href="/4.25/ja/academy/academy-introduction">TouchGFX Academy</a><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">コミュニティ</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.25/ja/docs/introduction/welcome">4.25</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r">4.25</a></li><li><a href="https://support.touchgfx.com/4.25" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.25<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.24" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.24<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.23" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.23<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.22" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.22<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.21" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.21<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.20" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.20<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.19" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.19<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_vrp6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">日本語</a><ul class="dropdown__menu"><li><a href="/4.25/docs/development/scenarios/running-graphics-on-stm32h7r" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/4.25/ko/docs/development/scenarios/running-graphics-on-stm32h7r" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li><li><a href="/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li><li><a href="/4.25/zh-CN/docs/development/scenarios/running-graphics-on-stm32h7r" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">简体中文</a></li><li><a href="/4.25/zh-TW/docs/development/scenarios/running-graphics-on-stm32h7r" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">繁體中文</a></li></ul></div><div class="searchBox_y6an"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_ovZa docsWrapper_a09d"><button aria-label="上へスクロールしてもどる" class="clean-btn theme-back-to-top-button backToTopButton_PCdr" type="button"></button><div class="docPage_CL8Z"><aside class="theme-doc-sidebar-container docSidebarContainer_ThtD"><div class="sidebarViewport_mAJy"><div class="sidebar_Oq1e"><nav aria-label="Docs sidebar（ドキュメント･サイドバー）" class="menu thin-scrollbar menu_M44W"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.25/ja/docs/category/introduction">概要</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;概要&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.25/ja/docs/category/basic-concepts">基本概念</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;基本概念&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/4.25/ja/docs/development/development-introduction">開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.25/ja/docs/development/hardware-selection/hardware-selection-introduction">ハードウェアの選択</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;ハードウェアの選択&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.25/ja/docs/development/board-bring-up/board-introduction">ボード立ち上げ</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;ボード立ち上げ&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.25/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL（抽象化レイヤ）開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;TouchGFX AL（抽象化レイヤ）開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.25/ja/docs/development/ui-development/ui-development-introduction">UI開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;UI開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/4.25/ja/docs/category/scenarios-2">シナリオ</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;シナリオ&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware">低コスト･ハードウェア上のTouchGFX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/touchgfx-on-gpu2d">NeoChrom / NeoChromVG上でのTouchGFXの使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.25/ja/docs/development/scenarios/running-graphics-on-stm32h7r">STM32H7R7 &amp; S7でのグラフィックスの実行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/running-graphics-from-external-ram">外部RAMからのグラフィックスの実行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">パーシャル･フレームバッファによるメモリ使用量の軽減</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/flash-limited">Flashメモリの使用量に制限のあるGUIの開発</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/using-non-memory-mapped-flash">画像保存のために非メモリ･マップドFlashを使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/using-serial-flash">画像とフォント用にシリアルFlashの使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/fonts-in-unmapped-flash">フォント･データ用に非メモリ･マップドFlashを使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/scenarios-change-pixelformat-bpp">アプリケーションのピクセル･フォーマットの変更</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/scenarios-create-at">TouchGFXボード設定の作成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/example-gpio">トリガとしての外部イベント</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/running-without-rtos">TouchGFX Board SetupでRTOSを使用せずに実行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/adding-files-to-stm32cubemx-projet">STM32CubeMXプロジェクトへのファイルの追加</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/converting-keil5-project-to-keil6">Keilコンパイラ5プロジェクトのKeilコンパイラ6への変換</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.25/ja/docs/development/scenarios/cmake-as-build-system">ビルド･システムとしてのCMake</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.25/ja/docs/category/miscellaneous-1">その他</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;その他&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.25/ja/docs/category/resources">リソース</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;リソース&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_fxxJ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_QTf6"><div id="doc-version-banner-identifier" class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>TouchGFX<!-- --> <b>4.25</b>のドキュメントですが、これはアクティブに保持されていません。</div><div class="margin-top--md">ドキュメントの最新版については、<b><a href="https://support.touchgfx.com/docs/development/scenarios/running-graphics-on-stm32h7r" target="_blank" rel="noopener noreferrer">最新版</a></b>を参照してください。</div></div><div class="docItemContainer_yTh1"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__o78" aria-label="パンくずリスト"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.25/ja/docs/development/development-introduction"><span itemprop="name">開発</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.25/ja/docs/category/scenarios-2"><span itemprop="name">シナリオ</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">STM32H7R7 &amp; S7でのグラフィックスの実行</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_CArF theme-doc-toc-mobile tocMobile_PMGv"><button type="button" class="clean-btn tocCollapsibleButton_I8Hj">このページでは</button></div><div class="theme-doc-markdown markdown"><header><h1>STM32H7R7 &amp; S7でのグラフィックスの実行</h1></header><p>この記事ではSTM32H7R/Sシリーズのマイクロコントローラ固有のアーキテクチャを取り上げ、これをグラフィックス用に使用するときに必要な考慮事項について説明します。 ただし、これらの考慮事項のほとんどは、外部RAMとFlashでグラフィックスを実行するすべてのSTM32マイクロコントローラに適用されます。</p><p>この記事は、TouchGFXボード･セットアップ（TBS）の作成方法に関する初心者向けガイドではありません。 STM32H7R/Sは高性能で高度なマイクロコントローラだからです。 したがって、この記事ではSTM32H7R/Sに固有で重要な領域にも踏み込みます。 TouchGFX TBSの作成方法に関する一般的な概要については、<a href="/4.25/ja/docs/development/board-bring-up/board-introduction">ボードの立ち上げに関するガイド</a>を参照してください。<br>
<!-- -->STM32H7R7/S7の詳細については、<a href="https://www.st.com/en/microcontrollers-microprocessors/stm32h7r7-7s7.html" target="_blank" rel="noopener noreferrer">製品ページ</a>または<a href="https://www.youtube.com/playlist?list=PLnMKNibPkDnF2fL7nhQ08V0bPi2poXVpH" target="_blank" rel="noopener noreferrer">STM32H7RSの完全なデモ･ワークショップを含むYouTubeプレイリスト</a>を参照してください。</p><p>TouchGFX DesignerにはSTM32H7S78 DK向けのTBSが含まれています。これはSTM32H7R/SでのTouchGFXの実行に関する完全なプロジェクト例です。 TBSは、STM32H7R/S向けにTouchGFXアプリケーションを開発する際のリファレンスとして使用できます。 このプロジェクトはSTM32CubeMXをベースにしているため、STM32H7S78-DK.iocファイルを開くことで、キャッシュ、MPU、外部メモリなどの推奨設定にアクセスできます。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/stm32h7s-tbs.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/stm32h7s-tbs.png"></a><p>TouchGFX Designerで使用できるTouchGFXボード･セットアップ</p></div><h2 class="anchor anchorWithStickyNavbar_k1OW" id="メモリのセットアップ">メモリのセットアップ<a href="#メモリのセットアップ" class="hash-link" aria-label="メモリのセットアップに直接リンク" title="メモリのセットアップに直接リンク">​</a></h2><p>STM32H7R/SはブートFlashマイコンです。 ブートFlashマイコンは、ブートローダを格納した小型の内蔵Flashメモリ搭載のマイクロコントローラで、メインのアプリケーションはアセットと一緒に外部メモリに配置されています。 STM32H7R/Sには620kBの内蔵SRAMも搭載されています。 このためSTM32H7R/Sは、グラフィックス･アプリケーションの使用時に外部RAMとFlashの両方に依存します。 グラフィックス用に外部メモリを使用する際には、外部メモリへのメモリ帯域幅がボトルネックになることが多くあります。外部メモリがCPU周波数の半分または3分の1の速度で動作するからです。 STM32H7R7/S7の場合、2つのXSPIインタフェース（16および8ビット）がダブル転送レートで最大200 MHzで実行動作で、FMC（16または32ビット）は最大100 MHzで動作可能です。</p><h3 class="anchor anchorWithStickyNavbar_k1OW" id="外部メモリマネージャ">外部メモリ･マネージャ<a href="#外部メモリマネージャ" class="hash-link" aria-label="外部メモリ･マネージャに直接リンク" title="外部メモリ･マネージャに直接リンク">​</a></h3><p>外部メモリ･マネージャと外部メモリ･ローダと呼ばれる2つのツールは、STM32CubeMXで［Categories］→［Middleware and Software Packs］を選択して使用できます。 これらのツールは、ブートFlashまたはFlashレスのアプリケーションで外部メモリをセットアップするユーザを支援するために作成されたものです。 外部ローダの作成やアプリケーション･タイプの選択などが簡単になります。 これらのツールの概要には<a href="https://wiki.st.com/stm32mcu/wiki/Getting_started_with_External_memory_Manager_and_External_memory_loader" target="_blank" rel="noopener noreferrer">こちら</a>からアクセスできます。 「Introduction to external serial memory with STM32（STM32での外部シリアル･メモリの概要）」という記事がまもなく公開される予定です。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><p>[外部メモリ･マネージャと外部メモリ･ローダの入門書]<!-- -->（<a href="https://wiki.st.com/stm32mcu/wiki/Getting_started_with_External_memory_Manager_and_External_memory_loader%EF%BC%89" target="_blank" rel="noopener noreferrer">https://wiki.st.com/stm32mcu/wiki/Getting_started_with_External_memory_Manager_and_External_memory_loader）</a></p></div></div><h3 class="anchor anchorWithStickyNavbar_k1OW" id="外部ramに配置したフレームバッファ">外部RAMに配置したフレームバッファ<a href="#外部ramに配置したフレームバッファ" class="hash-link" aria-label="外部RAMに配置したフレームバッファに直接リンク" title="外部RAMに配置したフレームバッファに直接リンク">​</a></h3><p>フレームバッファを外部RAMに配置する場合に最初に考慮すべき最も重要な事項は、メモリ帯域幅の要件と制約です。 GRAMを搭載しないディスプレイでは、ディスプレイごとに指定されたレートでフレームバッファを転送し続ける必要があります。 Discovery Kitで使用されるディスプレイの場合は60 Hzです。 つまり、LTDCの更新のためのみに、外部RAMインタフェース上の多くの帯域幅が占有されてしまうことになります。 LTDCで必要とされる帯域幅は次の計算で求められます。</p><p>ピクセル･クロック = LCD_CLK= 全スクリーンサイズ <!-- -->*<!-- --> リフレッシュレート<br>
<!-- -->必要な帯域幅（LTDCレイヤ1つあたり）= LCD_CLK <!-- -->*<!-- --> Bpp</p><p>さらに、DMA2DとGPU2Dもフレームバッファ上で操作を行うときに外部RAMの帯域幅を必要とします。 メモリが何か他のこと（アプリケーション･コードなど）にも使用されている場合は、帯域幅がさらに減らされます。<br>
<!-- -->これらの要因が組み合わさると、外部RAMのバスが混乱してしまいます。</p><p>外部RAM内のフレームバッファでグラフィックスを実行する場合の考慮事項を説明した記事には、<a href="/4.25/ja/docs/development/scenarios/running-graphics-from-external-ram">こちら</a>からアクセスできます。</p><p>外部RAMにLTDCディスプレイ･インタフェースとフレームバッファを配置する場合の制約と考慮事項については、<a href="https://www.st.com/resource/en/application_note/an4861-introduction-to-lcdtft-display-controller-ltdc-on-stm32-mcus-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">LTDCアプリケーション･ノート</a> を参照してください。 第5章「LTDCを用いたグラフィカル･アプリケーションの作成」と第7章「LTDCアプリケーション例」は、特に入念にご確認ください。<br>
<!-- -->外部RAMの帯域幅が制限に達している場合は、第5.5.2章「外部メモリからフェッチするLTDCフレームバッファの最適化」と第5.5.3章「SDRAMからフェッチするLTDCフレームバッファの最適化」の内容を検討してください。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><ul><li>[外部RAMからのグラフィックスの実行]<!-- -->（running-graphics-from-external-ram）</li><li>[AN4861: STM32マイクロコントローラのLCD-TFTディスプレイ･コントローラ（LTDC）の概要]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an4861-introduction-to-lcdtft-display-controller-ltdc-on-stm32-mcus-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an4861-introduction-to-lcdtft-display-controller-ltdc-on-stm32-mcus-stmicroelectronics.pdf）</a></li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_k1OW" id="密に結合されたメモリ">密に結合されたメモリ<a href="#密に結合されたメモリ" class="hash-link" aria-label="密に結合されたメモリに直接リンク" title="密に結合されたメモリに直接リンク">​</a></h3><p>STM32H7R/S Cortex-M7は、密に結合されたメモリ（TCM）への0ウェイトステートの64ビット幅ダイレクト･アクセスを特徴としています。 最大192 kBのデータTCM（DTCM）と命令TCM（ITCM）の両方を備えています。 このためDTCMはデータの読み出し/書き込み、ITCMは命令フェッチにとって最適なロケーションになっています。 したがって、ITCMは、キャッシュミスによる待ち時間が許容されない割込みハンドラや重要な制御ループなど、決定論的な実行を伴う重要なコードのために使用する必要があります。 RTOSを使用するリアルタイムのアプリケーションでは、一般的にヒープが大規模に使用されます。 このため、RTOSのスタックとヒープはDTCM内に配置することが推奨されます。 いくらかスペースが残っている場合は、グローバル変数もそこに配置することが可能です。</p><p>ITCMとDTCMは、SRAM1メモリとSRAM3メモリのある部分を使用するので、注意することが重要です。 このことは、ITCMとDTCMを使用すると内部SRAMのサイズが縮小することを意味します。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/tcm-illustration.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/tcm-illustration.png"></a><p>STM32H7R/Sの密に結合されたメモリの図</p></div><p>他のH7マイクロコントローラと同様に、STM32H7R/Sにはレベル1（L1）キャッシュがあります。 L1キャッシュの詳細については、<a href="https://www.st.com/resource/en/application_note/an4839-level-1-cache-on-stm32f7-series-and-stm32h7-series-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">H7キャッシュのアプリケーション･ノート</a>を参照してください。 第4章「ミスの予防とヒント」は特に注意して読んでください。</p><p>外部SPIメモリのセットアップ方法の詳細については、<a href="https://www.st.com/resource/en/application_note/an5050-getting-started-with-octospi-hexadecaspi-and-xspi-interface-on-stm32-mcus-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">OSPI、HSPI、XSPIのアプリケーション･ノート</a>を参照してください。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><ul><li>[AN6062: STM32H7Rx/7Sxシステム･ アーキテクチャとパフォーマンスの概要]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an6062-introduction-to-stm32h7rx7sx-system-architecture-and-performance-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an6062-introduction-to-stm32h7rx7sx-system-architecture-and-performance-stmicroelectronics.pdf）</a></li><li>[AN4839: STM32F7シリーズとSTM32H7シリーズのレベル1キャッシュ]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an4839-level-1-cache-on-stm32f7-series-and-stm32h7-series-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an4839-level-1-cache-on-stm32f7-series-and-stm32h7-series-stmicroelectronics.pdf）</a></li><li>[AN5050: STM32マイクロコントローラのOcto-SPI/Hexadeca-SPI/XSPIインタフェース入門]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an5050-getting-started-with-octospi-hexadecaspi-and-xspi-interface-on-stm32-mcus-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an5050-getting-started-with-octospi-hexadecaspi-and-xspi-interface-on-stm32-mcus-stmicroelectronics.pdf）</a></li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_k1OW" id="アプリケーションタイプ">アプリケーション･タイプ<a href="#アプリケーションタイプ" class="hash-link" aria-label="アプリケーション･タイプに直接リンク" title="アプリケーション･タイプに直接リンク">​</a></h2><p>起動時には、選択したアプリケーション･タイプによってブートローダの動作が異なります。 外部Flashにすでに配置済みのアプリケーションを示すか、アプリケーションを別のメモリ（通常は外部RAM）に読み込むかのどちらかが可能です。<br>
<!-- -->外部Flashにすでに配置済みのアプリケーションの実行は、XIP（Execute in Place）と呼ばれます。 ブート時にアプリケーションをFlashからRAMにコピーして、RAMから実行することは、LRUN（Load and Run）と呼ばれます。</p><p>アプリケーションが暗号化されている場合は、LRUNのみが使用できます。 STM32での暗号化の詳細については、<a href="https://www.st.com/resource/en/application_note/an6088-how-to-use-mce-for-encryptiondecryption-on-stm32-mcus-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">暗号化に関するアプリケーション･ノート</a>を参照してください。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><p>[AN6088: STM32マイクロコントローラでの暗号化/復号化にMCEを使用する方法]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an6088-how-to-use-mce-for-encryptiondecryption-on-stm32-mcus-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an6088-how-to-use-mce-for-encryptiondecryption-on-stm32-mcus-stmicroelectronics.pdf）</a></p></div></div><h3 class="anchor anchorWithStickyNavbar_k1OW" id="xipexecute-in-place">XiP（Execute in Place）<a href="#xipexecute-in-place" class="hash-link" aria-label="XiP（Execute in Place）に直接リンク" title="XiP（Execute in Place）に直接リンク">​</a></h3><p>グラフィックス･アプリケーション向けのXiPのメモリ･レイアウトの例を以下に示します。 XiPはデフォルトのアプリケーション･タイプです。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/xip-illustration.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/xip-illustration.png"></a><p>グラフィックス用のXiPアプリケーションの図</p></div><p>XiPの図に示すように、外部Flashに対するOctoSPIインタフェースは、アプリケーション･コードとグラフィックス･アセットの両方へのアクセスに使用されます。 CPUがアプリケーション･コードに常時アクセスするので、アセットへのアクセス時にNeoChrom GPUまたはChrom-ARTのアクセスが低速になる可能性があります。 このことはグラフィックス性能に悪影響を及ぼします。 この問題を緩和するために、XiPの実行時には外部Flashの命令キャッシュを有効にすることを強く推奨します。 これにより、繰り返しの命令が外部Flashではなくキャッシュから読み出されるようになるため、帯域幅の負荷が減り、外部Flashインタフェースの効率が向上します。</p><h3 class="anchor anchorWithStickyNavbar_k1OW" id="lrunload-and-run">LRUN（Load and Run）<a href="#lrunload-and-run" class="hash-link" aria-label="LRUN（Load and Run）に直接リンク" title="LRUN（Load and Run）に直接リンク">​</a></h3><p>LRUNに対応する例を以下の図に示します。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-illustration.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-illustration.png"></a><p>グラフィックス用のLRUNアプリケーションの図</p></div><p>LRUNの図に示すように、アプリケーション･コードがグラフィックス･アセットから切り離されるので、アセットのアクセスが向上します。 ただし、これにより外部RAMに対するインタフェースに負荷がかかります。フレームバッファとアプリケーション･コードの両方にアクセスする必要があるからです。 この場合は、外部RAMインタフェースで命令キャッシュを有効にすることを強く推奨します。</p><p>STM32H7R/S上のLRUNをグラフィックス･アプリケーションで使用する場合、可能な最高の性能を達成するためにいくつかの点を追加で考慮する必要があります。<br>
<!-- -->まず、アセット（ビットマップ、フォントなど）を外部Flash内に格納できるかどうか検討します。 これらのアセットを頻繁にアクセスするので、これらが外部RAMに格納されていると、外部RAMの帯域幅を大幅に圧迫することになります。 さらに、通常はアセットの暗号化は不要です。<br>
<!-- -->2つ目に、下の図に示すようにアプリケーション･コードが内部SRAMに収まるかどうか調査することは価値があります。 内部SRAMからであれば、外部Flashや外部RAMにある場合と比べて、アプリケーション･コードにさらに速くアクセスし実行することができます。内部バスの方が高速だからです。 内部SRAMの接続先であるSTM32H7R/SのAXIバスは、最大300 MHzの速度で動作できます。 さらに、この構成ではアセット、フレームバッファ、アプリケーション･コードを3つの異なる場所に配置できるので、3つの個別のバス間に帯域幅を分散できます。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-intram-illustration.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-intram-illustration.png"></a><p>アプリケーション･コードが内部RAMにある場合のグラフィックス用のLRUNアプリケーションの図</p></div><h3 class="anchor anchorWithStickyNavbar_k1OW" id="パフォーマンス比較">パフォーマンス比較<a href="#パフォーマンス比較" class="hash-link" aria-label="パフォーマンス比較に直接リンク" title="パフォーマンス比較に直接リンク">​</a></h3><p>XiPとLRUNをそれぞれ使用した複雑なGUIの例を以下に示します。 LRUNアプリケーションでは、内部SRAMにアプリケーション･コードがあります。 この比較では、異なる設定別にマイクロコントローラが受ける負荷を示しています。 TouchGFXフレームワークとアプリケーションを内部SRAMに配置することで、外部RAMとFlash内でのフェッチのサイクル数が減少し、マイクロコントローラの負荷が効果的に削減されます。<br>
<!-- -->リファレンスとなるデモは、STM32H7S78-DK向けのデモです。</p><div class="figure"><a href="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-xip-comparison.png" target="_blank"><img src="/4.25/ja/img/development/scenarios/running-graphics-on-stm32h7r/lrun-xip-comparison.png"></a><p>LRUNおよびXiPアプリケーションでのマイクロコントローラの負荷の比較</p></div><p>この比較からは、アプリケーション･コードを内部SRAMに配置した場合にマイクロコントローラの負荷が減少することがわかります。 LRUNを使用した場合、マイクロコントローラの負荷はXiPの場合と比べて約50%減少しています。</p><p>この比較からは、アプリケーション･コードを内部SRAMに配置した場合にマイクロコントローラの負荷が大幅に減少することがわかります。 内部SRAMのアクセス時間の方が外部RAMとFlashよりも高速だからです。 内部SRAMにあるアプリケーション･コードでLRUNを使用すると、マイクロコントローラの負荷がXiPの場合と比べて50%削減されます。 内部SRAMに格納されたアプリケーション･コードでLRUNを使用することで、最高のパフォーマンスを実現できるのです。 ただし、この構成は、使用可能な内部SRAM内にアプリケーション･コードが収まる場合にのみ実現可能です。</p><h2 class="anchor anchorWithStickyNavbar_k1OW" id="mpuの設定">MPUの設定<a href="#mpuの設定" class="hash-link" aria-label="MPUの設定に直接リンク" title="MPUの設定に直接リンク">​</a></h2><p>メモリ保護ユニット（MPU）は、意図しないメモリへのアクセスや実行からメモリ領域を保護するために使用されます。<br>
<!-- -->Arm® Cortex®-M7プロセッサでは投機的アクセスを防ぐことが重要です。外部メモリでこれが実行されると、高いレイテンシやシステムエラーの原因になるからです。 STM32H7R/Sでは、AXIマスタのメモリへのアクセスに影響し、グラフィックス性能が著しく低下します。<br>
<!-- -->MPUを使用して、アクセス可能なアドレス範囲を制御することで、投機的読み出しアクセスを防止できます。 このための最も簡単な方法は、メモリ領域全体でバックグラウンド領域を使用し、Strongly-Ordered、Execute-Neverに設定してアクセスを制限することです。</p><p>バックグラウンド領域はID -1のデフォルト領域内で定義する必要があります。これにより、その他すべての領域がこの領域よりも優先されることになるからです。 次に、アクセスの必要なメモリ領域に対して、その他のMPU領域をそれぞれの設定で定義する必要があります。 STM32H7R/Sでは最大16個の領域を定義できます。</p><p>STM32H7S78 DK TBSにおけるMPUの設定を以下に示します。 この設定はリファレンスとして使用できます。</p><table><thead><tr><th><strong>領域0</strong></th><th><strong>すべて</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x0</td><td></td></tr><tr><td>MPU領域サイズ</td><td>4 GB</td><td>マイクロコントローラの全メモリ領域に対応</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 0</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS NOT PERMITTED</td><td>すべてのアクセスを制限</td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUバッファ可能許可</td><td>DISABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域1</strong></th><th><strong>外部Flash</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x70000000</td><td>XSPI2のベース･アドレス（外部Flash）</td></tr><tr><td>MPU領域サイズ</td><td>128 MB</td><td>ボード上に128 MBの外部Flash</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 1</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUバッファ可能許可</td><td>ENABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域2</strong></th><th><strong>外部Flash</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域</td><td>Enabled</td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x70000000</td><td>XSPI2のベース･アドレス（外部Flash）</td></tr><tr><td>MPU領域サイズ</td><td>2 MB</td><td>外部Flashの最初の2 MBのプロパティで、アプリケーション･コードが配置され、上書きされる</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 1</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>ENABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUバッファ可能許可</td><td>ENABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域3</strong></th><th><strong>外部PSRAM</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x90000000</td><td>XSPI1のベース･アドレス（外部PSRAM）</td></tr><tr><td>MPU領域サイズ</td><td>32 MB</td><td>ボード上に32 MBの外部PSRAM</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 1</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUバッファ可能許可</td><td>DISABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域4</strong></th><th><strong>DTCM</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x20000000</td><td>DTCMのベース･アドレス</td></tr><tr><td>MPU領域サイズ</td><td>64 kB</td><td>DTCMのデフォルトの64 kB</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 1</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>DISABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>DISABLE</td><td>DTCM上でのキャッシュを無効にする（パフォーマンス向上をもたらさないため）</td></tr><tr><td>MPUバッファ可能許可</td><td>DISABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域5</strong></th><th><strong>SRAM</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x24000000</td><td>SRAM1のベース･アドレス</td></tr><tr><td>MPU領域サイズ</td><td>512 kB</td><td>SRAM1、SRAM2、SRAM3、SRAM4に対応</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 1</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUバッファ可能許可</td><td>ENABLE</td><td></td></tr></tbody></table><table><thead><tr><th><strong>領域6</strong></th><th><strong>GPU2Dコマンド･リスト</strong></th><th><strong>注</strong></th></tr></thead><tbody><tr><td><em>属性</em></td><td><em>値</em></td><td></td></tr><tr><td>MPU領域ベース･アドレス</td><td>0x2406e000</td><td>NeoChrom GPUコマンド･リストがここに配置される</td></tr><tr><td>MPU領域サイズ</td><td>16 kB</td><td>TouchGFX使用時のNeoChrom GPUコマンド･リストのデフォルト･サイズ（nema_hal.cで定義）</td></tr><tr><td>MPUサブ領域の無効化</td><td>0x0</td><td></td></tr><tr><td>MPU TEXフィールド･レベル</td><td>Level 0</td><td></td></tr><tr><td>MPUアクセス許可</td><td>ALL ACCESS PERMITTED</td><td></td></tr><tr><td>MPU命令アクセス</td><td>DISABLE</td><td></td></tr><tr><td>MPU共有可能許可</td><td>ENABLE</td><td></td></tr><tr><td>MPUキャッシュ可能許可</td><td>DISABLE</td><td>コマンド･リスト上のキャッシュを無効化</td></tr><tr><td>MPUバッファ可能許可</td><td>ENABLE</td><td></td></tr></tbody></table><p>グラフィックス固有のMPUの設定全般に関するヒントについては、<a href="https://www.st.com/resource/en/application_note/an4838-introduction-to-memory-protection-unit-management-on-stm32-mcus-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">LTDCアプリケーション･ノート</a>の第5.6.2章「メモリ保護ユニット（MPU）の設定」を参照してください。</p><p>さらなるリファレンスについては、<a href="https://www.st.com/resource/en/application_note/an4838-introduction-to-memory-protection-unit-management-on-stm32-mcus-stmicroelectronics.pdf" target="_blank" rel="noopener noreferrer">MPUアプリケーション･ノート</a>を参照してください。 第3章「Cortex-M0+/M3/M4/M7メモリタイプ、レジスタ、属性」と第6章「Armv6およびArmv7アーキテクチャにおけるSTM32Cube HALでのMPUの設定例」は特に入念にご確認ください。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><ul><li>[AN4861: STM32マイクロコントローラのLCD-TFTディスプレイ･コントローラ（LTDC）の概要]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an4861-introduction-to-lcdtft-display-controller-ltdc-on-stm32-mcus-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an4861-introduction-to-lcdtft-display-controller-ltdc-on-stm32-mcus-stmicroelectronics.pdf）</a></li><li>[AN4838: STM32マイクロコントローラにおけるメモリ保護ユニット管理の概要]<!-- -->（<a href="https://www.st.com/resource/en/application_note/an4838-introduction-to-memory-protection-unit-management-on-stm32-mcus-stmicroelectronics.pdf%EF%BC%89" target="_blank" rel="noopener noreferrer">https://www.st.com/resource/en/application_note/an4838-introduction-to-memory-protection-unit-management-on-stm32-mcus-stmicroelectronics.pdf）</a></li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_k1OW" id="デバッグ">デバッグ<a href="#デバッグ" class="hash-link" aria-label="デバッグに直接リンク" title="デバッグに直接リンク">​</a></h2><p>以下のガイドはSTM32CubeIDEにおけるSTM32H7R/Sのデバッグに関するもので、TouchGFX DesignerにあるTBS内のreadmeで入手できます。</p><p>STM32H7S78-DKのTBSのブートローダとアプリケーションの構造が原因で、IDEでのコードのデバッグは複雑になっています。 STM32CubeIDEでTouchGFXアプリケーションのコードを調べるには、以下の手順を実行します。</p><ol><li>TouchGFX Designerでコードを生成する。</li><li>STM32CubeIDEでプロジェクトを開く。</li><li>Bootプロジェクトのデバッグ･セッションを起動する。</li><li>コンパイルとフラッシングの完了を待つ。</li><li>デバッグ･セッションを終了する（Ctrl + F2）。</li><li>Appliプロジェクトのデバッグ･セッションを起動する。</li><li>コンパイルとフラッシングの完了を待つ。</li><li>［Resume (F8)］をクリックする。</li><li>STM32H7S78-DKボード上の黒いNRSTボタンを押す。</li><li>Appliプロジェクトのmain()の最初の行で、アプリケーションがブレーク･ポイントに達する。 そうでない場合は［Resume (F8)］を再度クリックする。</li><li>［Resume (F8)］や［Step Over (F6)］をクリックするなどで続行する。</li></ol><p>デバッグの詳細については、<a href="https://wiki.stmicroelectronics.cn/stm32mcu/wiki/Security:How_to_start_with_DA_access_on_STM32H7RS" target="_blank" rel="noopener noreferrer">STM32H7RS上のDAアクセスで開始する方法</a>に関するwikiページを参照してください。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content"><p>[STM32H7RS上のDAアクセスで開始する方法]<!-- -->（<a href="https://wiki.stmicroelectronics.cn/stm32mcu/wiki/Security:How_to_start_with_DA_access_on_STM32H7RS%EF%BC%89" target="_blank" rel="noopener noreferrer">https://wiki.stmicroelectronics.cn/stm32mcu/wiki/Security:How_to_start_with_DA_access_on_STM32H7RS）</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_k1OW" id="まとめとグラフィックスアプリケーションに関する一般的な推奨事項">まとめとグラフィックス･アプリケーションに関する一般的な推奨事項<a href="#まとめとグラフィックスアプリケーションに関する一般的な推奨事項" class="hash-link" aria-label="まとめとグラフィックス･アプリケーションに関する一般的な推奨事項に直接リンク" title="まとめとグラフィックス･アプリケーションに関する一般的な推奨事項に直接リンク">​</a></h2><p>これまで説明したように、STM32H7R/Sでグラフィックス･アプリケーションを開発する際には複数の考慮事項があります。 しかし、こうした考慮事項への注意を怠らなければ、高速のCPUと強力なGPU2Dによって優れたグラフィックス性能を達成することができます。</p><p>何よりもまず、外部メモリ･バスの帯域幅に注意を払うことが重要です。 これは外部RAMとFlashを使用するすべてのマイクロコントローラに適用されますが、ブートFlash構造を持つSTM32H7R/Sでは特に重要な考慮点になります。</p><p>重要な命令とデータをITCMおよびDTCMメモリ内に配置することで、パフォーマンスが大幅に向上します。</p><p>Arm® Cortex®-M7プロセッサに統合されたL1命令とデータ･キャッシュを有効にします。こうすることでもパフォーマンスが向上します。</p><p>アプリケーションの要件に基づいてXiPまたはLRUNのどちらを実行するのか選択します。ただし、メモリの帯域幅に注意してください。 アプリケーション･コードが内部SRAMに収まる場合は、LRUNが最高のパフォーマンスを実現します。</p><p>投機的読み出しアクセスは著しく性能を低下させる可能性があるため、これを防ぐことが重要です。 このためには、すべてのメモリ領域に適切なMPU設定を適用します。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメント･ページのナビゲーション"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.25/ja/docs/development/scenarios/touchgfx-on-gpu2d"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">NeoChrom / NeoChromVG上でのTouchGFXの使用</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.25/ja/docs/development/scenarios/running-graphics-from-external-ram"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">外部RAMからのグラフィックスの実行</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cuXu thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#メモリのセットアップ" class="table-of-contents__link toc-highlight">メモリのセットアップ</a><ul><li><a href="#外部メモリマネージャ" class="table-of-contents__link toc-highlight">外部メモリ･マネージャ</a></li><li><a href="#外部ramに配置したフレームバッファ" class="table-of-contents__link toc-highlight">外部RAMに配置したフレームバッファ</a></li><li><a href="#密に結合されたメモリ" class="table-of-contents__link toc-highlight">密に結合されたメモリ</a></li></ul></li><li><a href="#アプリケーションタイプ" class="table-of-contents__link toc-highlight">アプリケーション･タイプ</a><ul><li><a href="#xipexecute-in-place" class="table-of-contents__link toc-highlight">XiP（Execute in Place）</a></li><li><a href="#lrunload-and-run" class="table-of-contents__link toc-highlight">LRUN（Load and Run）</a></li><li><a href="#パフォーマンス比較" class="table-of-contents__link toc-highlight">パフォーマンス比較</a></li></ul></li><li><a href="#mpuの設定" class="table-of-contents__link toc-highlight">MPUの設定</a></li><li><a href="#デバッグ" class="table-of-contents__link toc-highlight">デバッグ</a></li><li><a href="#まとめとグラフィックスアプリケーションに関する一般的な推奨事項" class="table-of-contents__link toc-highlight">まとめとグラフィックス･アプリケーションに関する一般的な推奨事項</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2024 STMicroelectronics | <a href="https://www.st.com/content/st_com/ja/common/terms-of-use.html">ご利用条件</a> | <a href="https://www.st.com/content/st_com/ja/common/privacy-policy.html">プライバシー･ポリシー</a> | <a href="/docs/miscellaneous/cookie-policy">Cookieポリシー</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">権利行使</a></div></div></div></footer></div></div>
<script src="/4.25/ja/assets/js/runtime~main.cc0b2195.js"></script>
<script src="/4.25/ja/assets/js/main.d2537797.js"></script>
</body>
</html>